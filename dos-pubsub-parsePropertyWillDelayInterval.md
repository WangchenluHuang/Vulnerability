# Denial of Service Vulnerability in Solace PubSub+ Event Broker

### Product Information

project: https://solace.com/products/event-broker/software/getting-started

The PubSub+ software event broker is available as a container image, which allows a software event broker to run on a host system independent of a Virtual Machine Manager.

To get a PubSub+ Software Event Broker, you need to:

1. Pull the event broker image from the Docker repository.

2. Create the Container. There are many options that you can set with the `docker create` or `docker run` command that is used to build the event broker container. 

For detailed information, check out [Docker for Linux (solace.com)](https://docs.solace.com/Software-Broker/SW-Broker-Set-Up/Containers/Set-Up-Docker-Container-Linux.htm)

### Vulnerability Description

This security vulnerability exists in the Docker Container version of PubSub+ Event Broker Standard 10.5.1.29 and stems from a sub-process dataplane-linux when processing messages for inter-process communication (IPC) because of a null pointer call to the **ConnMqttParser::.parsePropertyWillDelayInterval** function terminates abnormally due to a null pointer call, which can be exploited by an attacker to cause a denial of service.

![fume-pubsub1.png](C:\Users\Administrator\Desktop\fume-pubsub1.png)

![图片1.png](C:\Users\Administrator\Desktop\图片1.png)

![图片2.png](C:\Users\Administrator\Desktop\图片2.png)

### Verify

Start running the container, using GDB to attach to the process listening on port 1883, Setting breakpoints at exception functions.

```bash
# find the processes listening to 1883
lsof -i:1883

# use gdb to analyse
gdb
gdb attach PID
(gdb) break ConnMqttParser::parsePropertyWillDelayInterval
(gdb) c
```

![图片3.png](C:\Users\Administrator\Desktop\图片3.png)

![图片4.png](C:\Users\Administrator\Desktop\图片4.png)

Sending a constructed poc to a port triggers the vulnerability

```bash
nc 127.0.0.1 1883 < poc.raw
```

Stop at the breakpoint, display /10i $pc, view the current execution and the next 10 lines of assembly code, ni run it line by line, find and record the memory address of the current interrupt, 0x00000000006fb655, and continue to run it with a segmentation error, and the container abnormally shuts down after the child process shuts down.

Before and after this interrupt instruction occurs, use the print $rax output to show the change in the RAX register, where RAX changes to a value of 0 and a null pointer appears before running instruction 0x6fb655.

![图片6.png](C:\Users\Administrator\Desktop\图片6.png)

![图片7.png](C:\Users\Administrator\Desktop\图片7.png)




